var gn=Object.defineProperty;var bn=(e,t,n)=>t in e?gn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Be=(e,t,n)=>(bn(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();function $(){}function wn(e){return e&&typeof e=="object"&&typeof e.then=="function"}function Pt(e){return e()}function at(){return Object.create(null)}function Y(e){e.forEach(Pt)}function vn(e){return typeof e=="function"}function se(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function An(e){return Object.keys(e).length===0}function Sn(e,...t){if(e==null)return $;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function de(e,t,n){e.$$.on_destroy.push(Sn(t,n))}function Se(e,t,n){return e.set(n),t}function f(e,t){e.appendChild(t)}function N(e,t,n){e.insertBefore(t,n||null)}function T(e){e.parentNode.removeChild(e)}function Ze(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function b(e){return document.createElement(e)}function ct(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function R(e){return document.createTextNode(e)}function O(){return R(" ")}function I(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function g(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function En(e){return Array.from(e.childNodes)}function re(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function M(e,t){e.value=t==null?"":t}function te(e,t,n,r){n===null?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}function ut(e,t){for(let n=0;n<e.options.length;n+=1){const r=e.options[n];if(r.__value===t){r.selected=!0;return}}e.selectedIndex=-1}function kn(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}let $e;function Cn(){if($e===void 0){$e=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{$e=!0}}return $e}function xn(e,t){getComputedStyle(e).position==="static"&&(e.style.position="relative");const r=b("iframe");r.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),r.setAttribute("aria-hidden","true"),r.tabIndex=-1;const o=Cn();let i;return o?(r.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",i=I(window,"message",s=>{s.source===r.contentWindow&&t()})):(r.src="about:blank",r.onload=()=>{i=I(r.contentWindow,"resize",t)}),f(e,r),()=>{(o||i&&r.contentWindow)&&i(),T(r)}}let ke;function K(e){ke=e}function Ve(){if(!ke)throw new Error("Function called outside component initialization");return ke}function Te(e){Ve().$$.on_mount.push(e)}function On(e){Ve().$$.after_update.push(e)}function Ln(e){Ve().$$.on_destroy.push(e)}const Ae=[],X=[],Fe=[],ft=[],jt=Promise.resolve();let Xe=!1;function Ut(){Xe||(Xe=!0,jt.then(et))}function ne(){return Ut(),jt}function Ce(e){Fe.push(e)}const Je=new Set;let qe=0;function et(){const e=ke;do{for(;qe<Ae.length;){const t=Ae[qe];qe++,K(t),Tn(t.$$)}for(K(null),Ae.length=0,qe=0;X.length;)X.pop()();for(let t=0;t<Fe.length;t+=1){const n=Fe[t];Je.has(n)||(Je.add(n),n())}Fe.length=0}while(Ae.length);for(;ft.length;)ft.pop()();Xe=!1,Je.clear(),K(e)}function Tn(e){if(e.fragment!==null){e.update(),Y(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Ce)}}const Ie=new Set;let oe;function tt(){oe={r:0,c:[],p:oe}}function nt(){oe.r||Y(oe.c),oe=oe.p}function P(e,t){e&&e.i&&(Ie.delete(e),e.i(t))}function Q(e,t,n,r){if(e&&e.o){if(Ie.has(e))return;Ie.add(e),oe.c.push(()=>{Ie.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}else r&&r()}function Nn(e,t){const n=t.token={};function r(o,i,s,l){if(t.token!==n)return;t.resolved=l;let c=t.ctx;s!==void 0&&(c=c.slice(),c[s]=l);const a=o&&(t.current=o)(c);let u=!1;t.block&&(t.blocks?t.blocks.forEach((h,y)=>{y!==i&&h&&(tt(),Q(h,1,1,()=>{t.blocks[y]===h&&(t.blocks[y]=null)}),nt())}):t.block.d(1),a.c(),P(a,1),a.m(t.mount(),t.anchor),u=!0),t.block=a,t.blocks&&(t.blocks[i]=a),u&&et()}if(wn(e)){const o=Ve();if(e.then(i=>{K(o),r(t.then,1,t.value,i),K(null)},i=>{if(K(o),r(t.catch,2,t.error,i),K(null),!t.hasCatch)throw i}),t.current!==t.pending)return r(t.pending,0),!0}else{if(t.current!==t.then)return r(t.then,1,t.value,e),!0;t.resolved=e}}function Bn(e,t,n){const r=t.slice(),{resolved:o}=e;e.current===e.then&&(r[e.value]=o),e.current===e.catch&&(r[e.error]=o),e.block.p(r,n)}function xe(e){e&&e.c()}function pe(e,t,n,r){const{fragment:o,on_mount:i,on_destroy:s,after_update:l}=e.$$;o&&o.m(t,n),r||Ce(()=>{const c=i.map(Pt).filter(vn);s?s.push(...c):Y(c),e.$$.on_mount=[]}),l.forEach(Ce)}function me(e,t){const n=e.$$;n.fragment!==null&&(Y(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function $n(e,t){e.$$.dirty[0]===-1&&(Ae.push(e),Ut(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ge(e,t,n,r,o,i,s,l=[-1]){const c=ke;K(e);const a=e.$$={fragment:null,ctx:null,props:i,update:$,not_equal:o,bound:at(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:at(),dirty:l,skip_bound:!1,root:t.target||c.$$.root};s&&s(a.root);let u=!1;if(a.ctx=n?n(e,t.props||{},(h,y,..._)=>{const m=_.length?_[0]:y;return a.ctx&&o(a.ctx[h],a.ctx[h]=m)&&(!a.skip_bound&&a.bound[h]&&a.bound[h](m),u&&$n(e,h)),y}):[],a.update(),u=!0,Y(a.before_update),a.fragment=r?r(a.ctx):!1,t.target){if(t.hydrate){const h=En(t.target);a.fragment&&a.fragment.l(h),h.forEach(T)}else a.fragment&&a.fragment.c();t.intro&&P(e.$$.fragment),pe(e,t.target,t.anchor,t.customElement),et()}K(c)}class be{$destroy(){me(this,1),this.$destroy=$}$on(t,n){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const o=r.indexOf(n);o!==-1&&r.splice(o,1)}}$set(t){this.$$set&&!An(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function qn(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function Fn(){return this.eachAfter(qn)}function In(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function Rn(e,t){for(var n=this,r=[n],o,i,s=-1;n=r.pop();)if(e.call(t,n,++s,this),o=n.children)for(i=o.length-1;i>=0;--i)r.push(o[i]);return this}function Mn(e,t){for(var n=this,r=[n],o=[],i,s,l,c=-1;n=r.pop();)if(o.push(n),i=n.children)for(s=0,l=i.length;s<l;++s)r.push(i[s]);for(;n=o.pop();)e.call(t,n,++c,this);return this}function zn(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function Pn(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,o=r&&r.length;--o>=0;)n+=r[o].value;t.value=n})}function jn(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Un(e){for(var t=this,n=Vn(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var o=r.length;e!==n;)r.splice(o,0,e),e=e.parent;return r}function Vn(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),o=null;for(e=n.pop(),t=r.pop();e===t;)o=e,e=n.pop(),t=r.pop();return o}function Hn(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function Jn(){return Array.from(this)}function Qn(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Wn(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*Dn(){var e=this,t,n=[e],r,o,i;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(o=0,i=r.length;o<i;++o)n.push(r[o]);while(n.length)}function rt(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Yn)):t===void 0&&(t=Xn);for(var n=new Oe(e),r,o=[n],i,s,l,c;r=o.pop();)if((s=t(r.data))&&(c=(s=Array.from(s)).length))for(r.children=s,l=c-1;l>=0;--l)o.push(i=s[l]=new Oe(s[l])),i.parent=r,i.depth=r.depth+1;return n.eachBefore(Zn)}function Gn(){return rt(this).eachBefore(Kn)}function Xn(e){return e.children}function Yn(e){return Array.isArray(e)?e[1]:null}function Kn(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Zn(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Oe(e){this.data=e,this.depth=this.height=0,this.parent=null}Oe.prototype=rt.prototype={constructor:Oe,count:Fn,each:In,eachAfter:Mn,eachBefore:Rn,find:zn,sum:Pn,sort:jn,path:Un,ancestors:Hn,descendants:Jn,leaves:Qn,links:Wn,copy:Gn,[Symbol.iterator]:Dn};function er(e,t){return e.parent===t.parent?1:2}function Qe(e){var t=e.children;return t?t[0]:e.t}function We(e){var t=e.children;return t?t[t.length-1]:e.t}function tr(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function nr(e){for(var t=0,n=0,r=e.children,o=r.length,i;--o>=0;)i=r[o],i.z+=t,i.m+=t,t+=i.s+(n+=i.c)}function rr(e,t,n){return e.a.parent===t.parent?e.a:n}function Re(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}Re.prototype=Object.create(Oe.prototype);function or(e){for(var t=new Re(e,0),n,r=[t],o,i,s,l;n=r.pop();)if(i=n._.children)for(n.children=new Array(l=i.length),s=l-1;s>=0;--s)r.push(o=n.children[s]=new Re(i[s],s)),o.parent=n;return(t.parent=new Re(null,0)).children=[t],t}function sr(){var e=er,t=1,n=1,r=null;function o(a){var u=or(a);if(u.eachAfter(i),u.parent.m=-u.z,u.eachBefore(s),r)a.eachBefore(c);else{var h=a,y=a,_=a;a.eachBefore(function(p){p.x<h.x&&(h=p),p.x>y.x&&(y=p),p.depth>_.depth&&(_=p)});var m=h===y?1:e(h,y)/2,d=m-h.x,S=t/(y.x+m+d),E=n/(_.depth||1);a.eachBefore(function(p){p.x=(p.x+d)*S,p.y=p.depth*E})}return a}function i(a){var u=a.children,h=a.parent.children,y=a.i?h[a.i-1]:null;if(u){nr(a);var _=(u[0].z+u[u.length-1].z)/2;y?(a.z=y.z+e(a._,y._),a.m=a.z-_):a.z=_}else y&&(a.z=y.z+e(a._,y._));a.parent.A=l(a,y,a.parent.A||h[0])}function s(a){a._.x=a.z+a.parent.m,a.m+=a.parent.m}function l(a,u,h){if(u){for(var y=a,_=a,m=u,d=y.parent.children[0],S=y.m,E=_.m,p=m.m,w=d.m,C;m=We(m),y=Qe(y),m&&y;)d=Qe(d),_=We(_),_.a=a,C=m.z+p-y.z-S+e(m._,y._),C>0&&(tr(rr(m,a,h),a,C),S+=C,E+=C),p+=m.m,S+=y.m,w+=d.m,E+=_.m;m&&!We(_)&&(_.t=m,_.m+=p-E),y&&!Qe(d)&&(d.t=y,d.m+=S-w,h=a)}return h}function c(a){a.x*=t,a.y=a.depth*n}return o.separation=function(a){return arguments.length?(e=a,o):e},o.size=function(a){return arguments.length?(r=!1,t=+a[0],n=+a[1],o):r?null:[t,n]},o.nodeSize=function(a){return arguments.length?(r=!0,t=+a[0],n=+a[1],o):r?[t,n]:null},o}var Ye="http://www.w3.org/1999/xhtml";const ht={svg:"http://www.w3.org/2000/svg",xhtml:Ye,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Vt(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),ht.hasOwnProperty(t)?{space:ht[t],local:e}:e}function ir(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Ye&&t.documentElement.namespaceURI===Ye?t.createElement(e):t.createElementNS(n,e)}}function lr(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Ht(e){var t=Vt(e);return(t.local?lr:ir)(t)}function ar(){}function Jt(e){return e==null?ar:function(){return this.querySelector(e)}}function cr(e){typeof e!="function"&&(e=Jt(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,l=r[o]=new Array(s),c,a,u=0;u<s;++u)(c=i[u])&&(a=e.call(c,c.__data__,u,i))&&("__data__"in c&&(a.__data__=c.__data__),l[u]=a);return new H(r,this._parents)}function ur(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function fr(){return[]}function hr(e){return e==null?fr:function(){return this.querySelectorAll(e)}}function dr(e){return function(){return ur(e.apply(this,arguments))}}function pr(e){typeof e=="function"?e=dr(e):e=hr(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var s=t[i],l=s.length,c,a=0;a<l;++a)(c=s[a])&&(r.push(e.call(c,c.__data__,a,s)),o.push(c));return new H(r,o)}function mr(e){return function(){return this.matches(e)}}function Qt(e){return function(t){return t.matches(e)}}var yr=Array.prototype.find;function _r(e){return function(){return yr.call(this.children,e)}}function gr(){return this.firstElementChild}function br(e){return this.select(e==null?gr:_r(typeof e=="function"?e:Qt(e)))}var wr=Array.prototype.filter;function vr(){return Array.from(this.children)}function Ar(e){return function(){return wr.call(this.children,e)}}function Sr(e){return this.selectAll(e==null?vr:Ar(typeof e=="function"?e:Qt(e)))}function Er(e){typeof e!="function"&&(e=mr(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,l=r[o]=[],c,a=0;a<s;++a)(c=i[a])&&e.call(c,c.__data__,a,i)&&l.push(c);return new H(r,this._parents)}function Wt(e){return new Array(e.length)}function kr(){return new H(this._enter||this._groups.map(Wt),this._parents)}function ze(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}ze.prototype={constructor:ze,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Cr(e){return function(){return e}}function xr(e,t,n,r,o,i){for(var s=0,l,c=t.length,a=i.length;s<a;++s)(l=t[s])?(l.__data__=i[s],r[s]=l):n[s]=new ze(e,i[s]);for(;s<c;++s)(l=t[s])&&(o[s]=l)}function Or(e,t,n,r,o,i,s){var l,c,a=new Map,u=t.length,h=i.length,y=new Array(u),_;for(l=0;l<u;++l)(c=t[l])&&(y[l]=_=s.call(c,c.__data__,l,t)+"",a.has(_)?o[l]=c:a.set(_,c));for(l=0;l<h;++l)_=s.call(e,i[l],l,i)+"",(c=a.get(_))?(r[l]=c,c.__data__=i[l],a.delete(_)):n[l]=new ze(e,i[l]);for(l=0;l<u;++l)(c=t[l])&&a.get(y[l])===c&&(o[l]=c)}function Lr(e){return e.__data__}function Tr(e,t){if(!arguments.length)return Array.from(this,Lr);var n=t?Or:xr,r=this._parents,o=this._groups;typeof e!="function"&&(e=Cr(e));for(var i=o.length,s=new Array(i),l=new Array(i),c=new Array(i),a=0;a<i;++a){var u=r[a],h=o[a],y=h.length,_=Nr(e.call(u,u&&u.__data__,a,r)),m=_.length,d=l[a]=new Array(m),S=s[a]=new Array(m),E=c[a]=new Array(y);n(u,h,d,S,E,_,t);for(var p=0,w=0,C,q;p<m;++p)if(C=d[p]){for(p>=w&&(w=p+1);!(q=S[w])&&++w<m;);C._next=q||null}}return s=new H(s,r),s._enter=l,s._exit=c,s}function Nr(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Br(){return new H(this._exit||this._groups.map(Wt),this._parents)}function $r(e,t,n){var r=this.enter(),o=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function qr(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,s=Math.min(o,i),l=new Array(o),c=0;c<s;++c)for(var a=n[c],u=r[c],h=a.length,y=l[c]=new Array(h),_,m=0;m<h;++m)(_=a[m]||u[m])&&(y[m]=_);for(;c<o;++c)l[c]=n[c];return new H(l,this._parents)}function Fr(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,i=r[o],s;--o>=0;)(s=r[o])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function Ir(e){e||(e=Rr);function t(h,y){return h&&y?e(h.__data__,y.__data__):!h-!y}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var s=n[i],l=s.length,c=o[i]=new Array(l),a,u=0;u<l;++u)(a=s[u])&&(c[u]=a);c.sort(t)}return new H(o,this._parents).order()}function Rr(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Mr(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function zr(){return Array.from(this)}function Pr(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null}function jr(){let e=0;for(const t of this)++e;return e}function Ur(){return!this.node()}function Vr(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],i=0,s=o.length,l;i<s;++i)(l=o[i])&&e.call(l,l.__data__,i,o);return this}function Hr(e){return function(){this.removeAttribute(e)}}function Jr(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Qr(e,t){return function(){this.setAttribute(e,t)}}function Wr(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Dr(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Gr(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Xr(e,t){var n=Vt(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Jr:Hr:typeof t=="function"?n.local?Gr:Dr:n.local?Wr:Qr)(n,t))}function Dt(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Yr(e){return function(){this.style.removeProperty(e)}}function Kr(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Zr(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function eo(e,t,n){return arguments.length>1?this.each((t==null?Yr:typeof t=="function"?Zr:Kr)(e,t,n==null?"":n)):to(this.node(),e)}function to(e,t){return e.style.getPropertyValue(t)||Dt(e).getComputedStyle(e,null).getPropertyValue(t)}function no(e){return function(){delete this[e]}}function ro(e,t){return function(){this[e]=t}}function oo(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function so(e,t){return arguments.length>1?this.each((t==null?no:typeof t=="function"?oo:ro)(e,t)):this.node()[e]}function Gt(e){return e.trim().split(/^|\s+/)}function ot(e){return e.classList||new Xt(e)}function Xt(e){this._node=e,this._names=Gt(e.getAttribute("class")||"")}Xt.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Yt(e,t){for(var n=ot(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function Kt(e,t){for(var n=ot(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function io(e){return function(){Yt(this,e)}}function lo(e){return function(){Kt(this,e)}}function ao(e,t){return function(){(t.apply(this,arguments)?Yt:Kt)(this,e)}}function co(e,t){var n=Gt(e+"");if(arguments.length<2){for(var r=ot(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?ao:t?io:lo)(n,t))}function uo(){this.textContent=""}function fo(e){return function(){this.textContent=e}}function ho(e){return function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}}function po(e){return arguments.length?this.each(e==null?uo:(typeof e=="function"?ho:fo)(e)):this.node().textContent}function mo(){this.innerHTML=""}function yo(e){return function(){this.innerHTML=e}}function _o(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}}function go(e){return arguments.length?this.each(e==null?mo:(typeof e=="function"?_o:yo)(e)):this.node().innerHTML}function bo(){this.nextSibling&&this.parentNode.appendChild(this)}function wo(){return this.each(bo)}function vo(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ao(){return this.each(vo)}function So(e){var t=typeof e=="function"?e:Ht(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Eo(){return null}function ko(e,t){var n=typeof e=="function"?e:Ht(e),r=t==null?Eo:typeof t=="function"?t:Jt(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Co(){var e=this.parentNode;e&&e.removeChild(this)}function xo(){return this.each(Co)}function Oo(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Lo(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function To(e){return this.select(e?Lo:Oo)}function No(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Bo(e){return function(t){e.call(this,t,this.__data__)}}function $o(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function qo(e){return function(){var t=this.__on;if(!!t){for(var n=0,r=-1,o=t.length,i;n<o;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function Fo(e,t,n){return function(){var r=this.__on,o,i=Bo(t);if(r){for(var s=0,l=r.length;s<l;++s)if((o=r[s]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=t;return}}this.addEventListener(e.type,i,n),o={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(o):this.__on=[o]}}function Io(e,t,n){var r=$o(e+""),o,i=r.length,s;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,a=l.length,u;c<a;++c)for(o=0,u=l[c];o<i;++o)if((s=r[o]).type===u.type&&s.name===u.name)return u.value}return}for(l=t?Fo:qo,o=0;o<i;++o)this.each(l(r[o],t,n));return this}function Zt(e,t,n){var r=Dt(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function Ro(e,t){return function(){return Zt(this,e,t)}}function Mo(e,t){return function(){return Zt(this,e,t.apply(this,arguments))}}function zo(e,t){return this.each((typeof t=="function"?Mo:Ro)(e,t))}function*Po(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length,s;o<i;++o)(s=r[o])&&(yield s)}var jo=[null];function H(e,t){this._groups=e,this._parents=t}function Uo(){return this}H.prototype={constructor:H,select:cr,selectAll:pr,selectChild:br,selectChildren:Sr,filter:Er,data:Tr,enter:kr,exit:Br,join:$r,merge:qr,selection:Uo,order:Fr,sort:Ir,call:Mr,nodes:zr,node:Pr,size:jr,empty:Ur,each:Vr,attr:Xr,style:eo,property:so,classed:co,text:po,html:go,raise:wo,lower:Ao,append:So,insert:ko,remove:xo,clone:To,datum:No,on:Io,dispatch:zo,[Symbol.iterator]:Po};function Me(e){return typeof e=="string"?new H([[document.querySelector(e)]],[document.documentElement]):new H([[e]],jo)}const le=[];function en(e,t=$){let n;const r=new Set;function o(l){if(se(e,l)&&(e=l,n)){const c=!le.length;for(const a of r)a[1](),le.push(a,e);if(c){for(let a=0;a<le.length;a+=2)le[a][0](le[a+1]);le.length=0}}}function i(l){o(l(e))}function s(l,c=$){const a=[l,c];return r.add(a),r.size===1&&(n=t(o)||$),l(e),()=>{r.delete(a),r.size===0&&(n(),n=null)}}return{set:o,update:i,subscribe:s}}let he=en([]),Ee=en(null);function ce(e){return e!=null&&typeof e=="object"&&e["@@functional/placeholder"]===!0}function Z(e){return function t(n){return arguments.length===0||ce(n)?t:e.apply(this,arguments)}}function He(e){return function t(n,r){switch(arguments.length){case 0:return t;case 1:return ce(n)?t:Z(function(o){return e(n,o)});default:return ce(n)&&ce(r)?t:ce(n)?Z(function(o){return e(o,r)}):ce(r)?Z(function(o){return e(n,o)}):e(n,r)}}}const tn=Array.isArray||function(t){return t!=null&&t.length>=0&&Object.prototype.toString.call(t)==="[object Array]"};function Vo(e){return Object.prototype.toString.call(e)==="[object String]"}function Pe(e,t){return Object.prototype.hasOwnProperty.call(t,e)}var dt=Object.prototype.toString,Ho=function(){return dt.call(arguments)==="[object Arguments]"?function(t){return dt.call(t)==="[object Arguments]"}:function(t){return Pe("callee",t)}}();const nn=Ho;var Jo=!{toString:null}.propertyIsEnumerable("toString"),pt=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],mt=function(){return arguments.propertyIsEnumerable("length")}(),Qo=function(t,n){for(var r=0;r<t.length;){if(t[r]===n)return!0;r+=1}return!1},Wo=Z(typeof Object.keys=="function"&&!mt?function(t){return Object(t)!==t?[]:Object.keys(t)}:function(t){if(Object(t)!==t)return[];var n,r,o=[],i=mt&&nn(t);for(n in t)Pe(n,t)&&(!i||n!=="length")&&(o[o.length]=n);if(Jo)for(r=pt.length-1;r>=0;)n=pt[r],Pe(n,t)&&!Qo(o,n)&&(o[o.length]=n),r-=1;return o});const yt=Wo;var Do=Z(function(t){return t===null?"Null":t===void 0?"Undefined":Object.prototype.toString.call(t).slice(8,-1)});const _t=Do;function Go(e){return e}var Xo=Z(Go);const Yo=Xo;function gt(e){for(var t=[],n;!(n=e.next()).done;)t.push(n.value);return t}function bt(e,t,n){for(var r=0,o=n.length;r<o;){if(e(t,n[r]))return!0;r+=1}return!1}function Ko(e){var t=String(e).match(/^function (\w*)/);return t==null?"":t[1]}function Zo(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}const De=typeof Object.is=="function"?Object.is:Zo;function wt(e,t,n,r){var o=gt(e),i=gt(t);function s(l,c){return st(l,c,n.slice(),r.slice())}return!bt(function(l,c){return!bt(s,c,l)},i,o)}function st(e,t,n,r){if(De(e,t))return!0;var o=_t(e);if(o!==_t(t))return!1;if(typeof e["fantasy-land/equals"]=="function"||typeof t["fantasy-land/equals"]=="function")return typeof e["fantasy-land/equals"]=="function"&&e["fantasy-land/equals"](t)&&typeof t["fantasy-land/equals"]=="function"&&t["fantasy-land/equals"](e);if(typeof e.equals=="function"||typeof t.equals=="function")return typeof e.equals=="function"&&e.equals(t)&&typeof t.equals=="function"&&t.equals(e);switch(o){case"Arguments":case"Array":case"Object":if(typeof e.constructor=="function"&&Ko(e.constructor)==="Promise")return e===t;break;case"Boolean":case"Number":case"String":if(!(typeof e==typeof t&&De(e.valueOf(),t.valueOf())))return!1;break;case"Date":if(!De(e.valueOf(),t.valueOf()))return!1;break;case"Error":return e.name===t.name&&e.message===t.message;case"RegExp":if(!(e.source===t.source&&e.global===t.global&&e.ignoreCase===t.ignoreCase&&e.multiline===t.multiline&&e.sticky===t.sticky&&e.unicode===t.unicode))return!1;break}for(var i=n.length-1;i>=0;){if(n[i]===e)return r[i]===t;i-=1}switch(o){case"Map":return e.size!==t.size?!1:wt(e.entries(),t.entries(),n.concat([e]),r.concat([t]));case"Set":return e.size!==t.size?!1:wt(e.values(),t.values(),n.concat([e]),r.concat([t]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var s=yt(e);if(s.length!==yt(t).length)return!1;var l=n.concat([e]),c=r.concat([t]);for(i=s.length-1;i>=0;){var a=s[i];if(!(Pe(a,t)&&st(t[a],e[a],l,c)))return!1;i-=1}return!0}var es=He(function(t,n){return st(t,n,[],[])});const rn=es;function ts(e,t,n){var r,o;if(typeof e.indexOf=="function")switch(typeof t){case"number":if(t===0){for(r=1/t;n<e.length;){if(o=e[n],o===0&&1/o===r)return n;n+=1}return-1}else if(t!==t){for(;n<e.length;){if(o=e[n],typeof o=="number"&&o!==o)return n;n+=1}return-1}return e.indexOf(t,n);case"string":case"boolean":case"function":case"undefined":return e.indexOf(t,n);case"object":if(t===null)return e.indexOf(t,n)}for(;n<e.length;){if(rn(e[n],t))return n;n+=1}return-1}function ns(e){return Object.prototype.toString.call(e)==="[object Object]"}function rs(e){var t=Object.prototype.toString.call(e);return t==="[object Uint8ClampedArray]"||t==="[object Int8Array]"||t==="[object Uint8Array]"||t==="[object Int16Array]"||t==="[object Uint16Array]"||t==="[object Int32Array]"||t==="[object Uint32Array]"||t==="[object Float32Array]"||t==="[object Float64Array]"||t==="[object BigInt64Array]"||t==="[object BigUint64Array]"}var os=Z(function(t){return t!=null&&typeof t["fantasy-land/empty"]=="function"?t["fantasy-land/empty"]():t!=null&&t.constructor!=null&&typeof t.constructor["fantasy-land/empty"]=="function"?t.constructor["fantasy-land/empty"]():t!=null&&typeof t.empty=="function"?t.empty():t!=null&&t.constructor!=null&&typeof t.constructor.empty=="function"?t.constructor.empty():tn(t)?[]:Vo(t)?"":ns(t)?{}:nn(t)?function(){return arguments}():rs(t)?t.constructor.from(""):void 0});const ss=os;var is=He(function(t,n){return typeof n.indexOf=="function"&&!tn(n)?n.indexOf(t):ts(n,t,0)});const ls=is;var as=Z(function(t){return t!=null&&rn(t,ss(t))});const cs=as;var us=He(function(t,n){var r=Number(n),o=0,i;if(r<0||isNaN(r))throw new RangeError("n must be a non-negative number");for(i=new Array(r);o<r;)i[o]=t(o),o+=1;return i});const ye=us;var fs=He(function(t,n){for(var r=[],o=0,i=Math.min(t.length,n.length);o<i;)r[o]=[t[o],n[o]],o+=1;return r});const hs=fs;function ds(e){let t,n,r,o,i,s,l,c,a,u=e[2].qstr+"",h,y,_,m,d,S,E,p;return{c(){t=b("div"),n=b("h2"),r=R(`Query Plan
    `),o=b("button"),o.textContent="prev (\u2190)",i=O(),s=b("button"),s.textContent="next (\u2192)",l=O(),c=b("pre"),a=b("code"),h=R(u),y=O(),_=ct("svg"),m=ct("g"),g(o,"class","btn btn-sm btn-outline-primary"),g(s,"class","btn btn-sm btn-outline-primary"),g(a,"class","queryText svelte-fq36k7"),g(c,"class","prequery svelte-fq36k7"),g(m,"id","qPlanTree"),g(m,"transform",d=`translate(${e[0].l}, ${e[0].t})`),g(_,"id","qPlanTreeSVG"),Ce(()=>e[18].call(t))},m(w,C){N(w,t,C),f(t,n),f(n,r),f(n,o),f(n,i),f(n,s),f(t,l),f(t,c),f(c,a),f(a,h),f(t,y),f(t,_),f(_,m),e[16](m),e[17](_),S=xn(t,e[18].bind(t)),E||(p=[I(window,"keydown",e[6]),I(o,"click",e[14]),I(s,"click",e[15])],E=!0)},p(w,[C]){C&4&&u!==(u=w[2].qstr+"")&&re(h,u),C&1&&d!==(d=`translate(${w[0].l}, ${w[0].t})`)&&g(m,"transform",d)},i:$,o:$,d(w){w&&T(t),e[16](null),e[17](null),S(),E=!1,Y(p)}}}function ps(e,t,n){let r,o;de(e,he,v=>n(13,r=v)),de(e,Ee,v=>n(2,o=v));let{h:i}=t,{margin:s={t:50,r:0,b:50,l:0}}=t,l=null,c=null,a,u,h=!1,y=null,_=0,m,d,S=[],E,p;function w(v,A){if(cs(A[v]))return[v];let x=[];return A[v].forEach(k=>{x=x.concat(w(k,A))}),x.push(v),x}let C=0;function q(v){C+=v,C=Math.max(Math.min(C,S.length-1),0),Se(he,r=[S[C]],r)}function J(v){v.key=="ArrowLeft"?q(-1):v.key=="ArrowRight"&&q(1)}Te(()=>{n(10,h=!0)});async function j(){var v=Me(E),A=Me(p);A.selectAll("*").remove(),await ne(),console.log(E.parentNode),console.log(_),y=sr().size([_-s.l-s.r,i-s.t-s.b]),u=y(u),v.attr("height",i).attr("width",_),A.selectAll(".link").data(u.descendants().slice(1)).enter().append("path").attr("class","link").attr("fill","none").attr("stroke","grey").attr("marker-end","url(#arrowHead)").attr("d",k=>`M${k.x},${k.y}C${(k.x+k.parent.x)/2},${k.y} ${(k.x+k.parent.x)/2},${k.parent.y} ${k.parent.x},${k.parent.y}`);let x=A.selectAll(".node").data(u.descendants()).enter().append("g").attr("class",k=>`node opNode ${k.children?"node--internal":" node--leaf"}`).attr("transform",k=>`translate(${k.x},${k.y})`);n(11,m=x.append("text").text(k=>c[k.data.id].name).style("text-anchor","middle").attr("role","button").on("click",async function(){let k=[this.__data__.data.id].flat()[0];Se(he,r=[],r),await ne(),Se(he,r=[k],r),C=ls(k,S)})),n(12,d={}),m.each(function(){n(12,d[this.__data__.data.id]=this,d)}),C=0,q(0),await ne()}const z=()=>q(-1),U=()=>q(1);function D(v){X[v?"unshift":"push"](()=>{p=v,n(4,p)})}function F(v){X[v?"unshift":"push"](()=>{E=v,n(3,E)})}function L(){_=this.clientWidth,n(1,_)}return e.$$set=v=>{"h"in v&&n(7,i=v.h),"margin"in v&&n(0,s=v.margin)},e.$$.update=()=>{e.$$.dirty&1798&&_&&(n(8,l=o.op),c=o.info,n(9,a={id:l.root,queryPlan:l}),u=rt(a,v=>{var x;return(x=l[v.id])==null?void 0:x.map(k=>({id:k,queryPlan:l}))}),S=w(l.root[0],l),h&&j()),e.$$.dirty&14336&&d&&(m.attr("fill","black").attr("font-size","medium"),(r!=null?r:[]).forEach(A=>{!d[A]||Me(d[A]).attr("fill","red").attr("font-size","x-large")}))},[s,_,o,E,p,q,J,i,l,a,h,m,d,r,z,U,D,F,L]}class ms extends be{constructor(t){super(),ge(this,t,ps,ds,se,{h:7,margin:0})}}function W({columns:e,rows:t}){return{col_labels:e,row_labels:ye(Yo,t.length),data:t}}function we(e,t,n,r,o){let i=null;return n?i={lhs:t,lhs2:n,rhs:r}:i={lhs:t,rhs:r},{css_id:e,tables:i,expr:{code:"",range:{start:{line:0,ch:0},end:{line:1,ch:0}}},annotations:o}}function ys(e,t,n){let r=t.op[e],o=t.results[t.op[e][0]],i=t.results[e],s=t.col[e];n.desc="Projection - keeping the fields: "+r.str,n.opType="projectionOp",n.tableCaptions.lhs=t.info[t.op[e][0]].name,n.tableCaptions.rhs=r.name;let l=[];return s.forEach((c,a)=>{c.forEach(u=>{l.push({type:"arrow",from:{table:"lhs",row:"header",col:u},to:{table:"rhs",row:"header",col:a}})})}),ye(c=>{s.flat().includes(c)||l.push({type:"crossout",target:{table:"lhs",row:"all",col:c}})},o.columns.length),ye(c=>{l.push({type:"color_set",set:[{table:"lhs",row:c,col:"all"},{table:"rhs",row:c,col:"all"}]})},i.rows.length),we(r.name,W(o),null,W(i),l)}function on(e,t,n){var r;(r=t.exprs[e])==null||r.forEach(([o,i])=>{let s=o==0?"lhs":"lhs2";i.forEach(l=>n.push({type:"box",target:{table:s,row:"all",col:l}}))})}function vt(e,t,n){let r=t.results[t.op[e][0]],o=t.results[t.op[e][1]],i=t.results[e],s=t.row[e];t.col[e];let l=t.info[e];n.desc="matches up tuples of both tables based on condition: "+l.str,n.opType="hashJoinOp",n.tableCaptions.lhs=t.info[t.op[e][0]].name,n.tableCaptions.lhs2=t.info[t.op[e][1]].name,n.tableCaptions.rhs=l.name;let c=[];on(e,t,c),console.log(s);let a=s[0][1],u=s[1][1];hs(a,u).forEach(([[m,d],[S,E]])=>{let p={table:"lhs",col:"all",row:d},w={table:"lhs2",col:"all",row:E},C={table:"rhs",col:"all",row:m};c.push({type:"color_set",set:[p,w,C]}),c.push({type:"arrow",from:p,to:w})});let h=W(r),y=W(o),_=W(i);return we(l.name,h,y,_,c)}function _s(e,t,n){let r=W(t.results[t.op[e][0]]),o=W(t.results[e]),i=t.row[e],s=t.info[e];n.desc="Groups rows and merges their data: "+s.str,n.opType="hashGroupOp",n.tableCaptions.lhs=t.info[t.op[e][0]].name,n.tableCaptions.rhs=s.name;let l=[],c=ye(a=>({type:"color_set",set:[{table:"rhs",row:a,col:"all"}]}),o.data.length);return i.forEach(([a,u])=>{u.forEach(([h,y])=>{let _={table:"lhs",col:"all",row:y},m={table:"rhs",col:"all",row:h};l.push({type:"arrow",from:_,to:m}),c[h].set.push(_)})}),l=l.concat(c),we(s.name,r,null,o,l)}function gs(e,t,n){let r=W(t.results[t.op[e][0]]),o=W(t.results[e]),i=t.row[e],s=t.info[e];n.desc="Filter - only keeping tuples meeting the condition: "+s.str,n.opType="filterOp",n.tableCaptions.lhs=t.info[t.op[e][0]].name,n.tableCaptions.rhs=s.name;let l=[],c=[];on(e,t,l),i[0][1].forEach(([u,h])=>{let y={table:"lhs",row:h,col:"all"},_={table:"rhs",row:u,col:"all"};l.push({type:"color_set",set:[y,_]}),l.push({type:"arrow",from:y,to:_})});let a=i[0][1].map(([u,h])=>h);return ye(u=>{a.includes(u)||l.push({type:"crossout",target:{table:"lhs",row:u,col:"all"}})},r.data.length),l=c.concat(l),we(s.name,r,null,o,l)}function bs(e,t,n){let r=W(t.results[e]),o=r,i=t.info[e];t.row[e],n.desc="Scans all the tuples of the input table "+i.str,n.opType="scanOp",n.tableCaptions.lhs=i.name,n.tableCaptions.rhs=i.name;let s=[];return ye(l=>{let c={table:"lhs",row:l,col:"all"},a={table:"rhs",row:l,col:"all"};s.push({type:"color_set",set:[c,a]}),s.push({type:"arrow",from:c,to:a})},o.data.length),we(i.name,r,null,o,s)}function ws(e,t,n){let r=W(t.results[e]),o=t.info[e];return n.opType="queryOp",n.tableCaptions.lhs=o.name,we(o.name,r,null,null,[])}function At(e){let t,n,r,o,i;return{c(){t=b("div"),n=b("p"),r=R(e[2]),o=O(),i=b("p"),i.innerHTML='Help us <a href="https://github.com/cudbg/sqltutor">add it to the codebase</a>!',g(t,"class","bd-callout svelte-1dmtwhn")},m(s,l){N(s,t,l),f(t,n),f(n,r),f(t,o),f(t,i)},p(s,l){l&4&&re(r,s[2])},d(s){s&&T(t)}}}function vs(e){let t,n,r=e[1].name+"",o,i,s,l,c=e[1].id+"",a,u,h,y=e[1].str+"",_,m,d,S,E,p=e[2]&&At(e);return{c(){t=b("div"),n=b("h3"),o=R(r),i=O(),s=b("small"),l=R("id: "),a=R(c),u=O(),h=b("p"),_=R(y),m=O(),d=b("div"),E=O(),p&&p.c(),g(s,"class","text-muted"),g(n,"class","stepHeader"),g(h,"class","stepDesc"),g(d,"id",S=`vis-${e[0]}`),g(t,"class","step")},m(w,C){N(w,t,C),f(t,n),f(n,o),f(n,i),f(n,s),f(s,l),f(s,a),f(t,u),f(t,h),f(h,_),f(t,m),f(t,d),e[5](d),f(t,E),p&&p.m(t,null)},p(w,[C]){C&2&&r!==(r=w[1].name+"")&&re(o,r),C&2&&c!==(c=w[1].id+"")&&re(a,c),C&2&&y!==(y=w[1].str+"")&&re(_,y),C&1&&S!==(S=`vis-${w[0]}`)&&g(d,"id",S),w[2]?p?p.p(w,C):(p=At(w),p.c(),p.m(t,null)):p&&(p.d(1),p=null)},i:$,o:$,d(w){w&&T(t),e[5](null),p&&p.d()}}}function As(e,t,n){let r;de(e,Ee,d=>n(4,r=d));const o={Project:ys,HashJoin:vt,ThetaJoin:vt,GroupBy:_s,Filter:gs,Scan:bs,Collect:ws};let i=null,{opid:s}=t,l={},c={},a=()=>"";console.log("lineageStep setup",r);let u=null,h=null;function y(){if(s==null)return;if(u&&u.destroy(),!a){n(2,i="Don't know how to render this yet :(");return}n(2,i=null);let d=a(s,r,c),S={type:"sql",trace:[d]};console.log(S);try{u=createVisualizer(`#vis-${s}`,S)}catch(E){console.error(E)}finally{_()}}function _(){let d=Me(h.querySelector(".table_pair"));d.select(".leftWST .wstRoot").insert("caption",":first-child").text(c.tableCaptions.lhs),c.tableCaptions.lhs2&&d.select(".leftWST2 .wstRoot").insert("caption",":first-child").text(c.tableCaptions.lhs2),d.select(".rightWST .wstRoot").insert("caption",":first-child").text(c.tableCaptions.rhs)}Te(()=>{}),On(async()=>{console.log("afterupdate"),y(),await ne(),y()}),Ln(()=>{console.log("destroy"),u&&u.destroy()});function m(d){X[d?"unshift":"push"](()=>{h=d,n(3,h)})}return e.$$set=d=>{"opid"in d&&n(0,s=d.opid)},e.$$.update=()=>{var d;e.$$.dirty&19&&(n(1,l=(d=r.info[s])!=null?d:{}),c={opID:s,opType:null,headerName:l.name,desc:null,tableCaptions:{lhs:null,lhs2:null,rhs:null}},a=o[l.name])},[s,l,i,h,r,m]}class Ss extends be{constructor(t){super(),ge(this,t,As,vs,se,{opid:0})}}function St(e,t,n){const r=e.slice();return r[3]=t[n],r}function Et(e){let t,n;return t=new Ss({props:{opid:e[3]}}),{c(){xe(t.$$.fragment)},m(r,o){pe(t,r,o),n=!0},p(r,o){const i={};o&2&&(i.opid=r[3]),t.$set(i)},i(r){n||(P(t.$$.fragment,r),n=!0)},o(r){Q(t.$$.fragment,r),n=!1},d(r){me(t,r)}}}function Es(e){let t,n,r=[e[1]].flat(),o=[];for(let s=0;s<r.length;s+=1)o[s]=Et(St(e,r,s));const i=s=>Q(o[s],1,1,()=>{o[s]=null});return{c(){t=b("div");for(let s=0;s<o.length;s+=1)o[s].c();g(t,"id","vis")},m(s,l){N(s,t,l);for(let c=0;c<o.length;c+=1)o[c].m(t,null);e[2](t),n=!0},p(s,[l]){if(l&2){r=[s[1]].flat();let c;for(c=0;c<r.length;c+=1){const a=St(s,r,c);o[c]?(o[c].p(a,l),P(o[c],1)):(o[c]=Et(a),o[c].c(),P(o[c],1),o[c].m(t,null))}for(tt(),c=r.length;c<o.length;c+=1)i(c);nt()}},i(s){if(!n){for(let l=0;l<r.length;l+=1)P(o[l]);n=!0}},o(s){o=o.filter(Boolean);for(let l=0;l<o.length;l+=1)Q(o[l]);n=!1},d(s){s&&T(t),Ze(o,s),e[2](null)}}}function ks(e,t,n){let r;de(e,he,s=>n(1,r=s));let o;Te(()=>{});function i(s){X[s?"unshift":"push"](()=>{o=s,n(0,o)})}return[o,r,i]}class Cs extends be{constructor(t){super(),ge(this,t,ks,Es,se,{})}}const kt=[{name:"select all",q:"select * from sailors"},{name:"groupby having",q:`SELECT s.sid, sum(s.age)
FROM sailors as s,
     reserves as r
WHERE s.sid = r.sid
GROUP BY s.sid
HAVING count(1) > 1`},{name:"subquery",q:`SELECT x, d
FROM (SELECT a*b as x, c, d 
      FROM data) AS d2 
WHERE c = 0`},{name:"subquery groupby",q:`SELECT c, sum(x)
FROM (SELECT a*b as x, c, d 
      FROM data) AS d2 
GROUP BY c`},{name:"subquery join",q:`SELECT a, sum(b+2) * 2 as c 
FROM data, 
     (SELECT a*b as x, c, d 
      FROM data) AS d2 
WHERE data.b = d2.x
GROUP BY a`}];function Ct(e,t,n){const r=e.slice();return r[4]=t[n].name,r[5]=t[n].q,r[7]=n,r}function xt(e){let t,n=e[4]+"",r;return{c(){t=b("option"),r=R(n),t.__value=e[5],t.value=t.__value},m(o,i){N(o,t,i),f(t,r)},p:$,d(o){o&&T(t)}}}function xs(e){let t,n,r,o,i=kt,s=[];for(let l=0;l<i.length;l+=1)s[l]=xt(Ct(e,i,l));return{c(){t=b("select"),n=b("option"),n.textContent="Choose a query";for(let l=0;l<s.length;l+=1)s[l].c();n.selected=!0,n.__value=null,n.value=n.__value,g(t,"class"," svelte-zqfjog"),g(t,"aria-label","Select a query"),e[0]===void 0&&Ce(()=>e[3].call(t))},m(l,c){N(l,t,c),f(t,n);for(let a=0;a<s.length;a+=1)s[a].m(t,null);ut(t,e[0]),r||(o=[I(t,"change",e[3]),I(t,"change",e[1])],r=!0)},p(l,[c]){if(c&0){i=kt;let a;for(a=0;a<i.length;a+=1){const u=Ct(l,i,a);s[a]?s[a].p(u,c):(s[a]=xt(u),s[a].c(),s[a].m(t,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=i.length}c&1&&ut(t,l[0])},i:$,o:$,d(l){l&&T(t),Ze(s,l),r=!1,Y(o)}}}function Os(e,t,n){let{onSelect:r}=t,o;function i(){o&&r(o)}function s(){o=kn(this),n(0,o)}return e.$$set=l=>{"onSelect"in l&&n(2,r=l.onSelect)},[o,i,r,s]}class Ls extends be{constructor(t){super(),ge(this,t,Os,xs,se,{onSelect:2})}}function Ts(e){let t,n,r,o,i;return{c(){t=b("textarea"),n=O(),r=b("input"),g(t,"placeholder","Optionally describe the expected functionality, error, or feature request."),g(t,"class","svelte-uxtnz8"),g(r,"placeholder","Optional email if you want a reply"),g(r,"class","svelte-uxtnz8")},m(s,l){N(s,t,l),M(t,e[1]),N(s,n,l),N(s,r,l),M(r,e[2]),o||(i=[I(t,"input",e[7]),I(r,"input",e[8])],o=!0)},p(s,l){l&2&&M(t,s[1]),l&4&&r.value!==s[2]&&M(r,s[2])},d(s){s&&T(t),s&&T(n),s&&T(r),o=!1,Y(i)}}}function Ns(e){let t;return{c(){t=R("Thanks!")},m(n,r){N(n,t,r)},p:$,d(n){n&&T(t)}}}function Bs(e){let t,n,r,o,i,s,l,c,a,u,h;function y(d,S){return d[3]?Ns:Ts}let _=y(e),m=_(e);return{c(){t=b("div"),n=b("div"),r=b("div"),o=b("div"),m.c(),i=O(),s=b("div"),l=b("button"),l.textContent="Cancel",c=O(),a=b("button"),a.textContent="Submit",g(o,"class","modal-body"),g(l,"type","button"),g(l,"class","btn btn-secondary"),g(l,"data-bs-dismiss","modal"),g(a,"type","button"),g(a,"class","btn btn-primary"),g(s,"class","modal-footer"),g(r,"class","modal-content"),g(n,"class","modal-dialog"),g(t,"class","modal fade"),g(t,"id",e[0]),g(t,"tabindex","-1"),g(t,"aria-labelledby","exampleModalLabel"),g(t,"aria-hidden","true")},m(d,S){N(d,t,S),f(t,n),f(n,r),f(r,o),m.m(o,null),f(r,i),f(r,s),f(s,l),f(s,c),f(s,a),e[9](t),u||(h=I(a,"click",e[5]),u=!0)},p(d,[S]){_===(_=y(d))&&m?m.p(d,S):(m.d(1),m=_(d),m&&(m.c(),m.m(o,null))),S&1&&g(t,"id",d[0])},i:$,o:$,d(d){d&&T(t),m.d(),e[9](null),u=!1,h()}}}function $s(e,t,n){let{id:r,reportBug:o}=t,i=null,s=null,l=!1,c=null,a=null;Te(()=>{c=new bootstrap.Modal("#"+r,{}),a.addEventListener("hidden.bs.modal",()=>{n(3,l=!1)})});function u(){o(i,s),n(1,i=n(2,s=null)),n(3,l=!0),setTimeout(()=>{c.hide()},600)}function h(){i=this.value,n(1,i)}function y(){s=this.value,n(2,s)}function _(m){X[m?"unshift":"push"](()=>{a=m,n(4,a)})}return e.$$set=m=>{"id"in m&&n(0,r=m.id),"reportBug"in m&&n(6,o=m.reportBug)},[r,i,s,l,a,u,o,h,y,_]}class qs extends be{constructor(t){super(),ge(this,t,$s,Bs,se,{id:0,reportBug:6})}}const sn={230:[[0,[[0,0],[1,1]]]],231:[[0,[[0,0],[1,1]]]],233:[[0,[[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6],[7,7],[8,8],[9,9],[10,10],[11,11],[12,12],[13,13],[14,14],[15,15],[16,16],[17,17],[18,18],[19,19]]]],234:[],236:[[0,[[0,0],[0,1],[0,2],[0,3],[1,4],[2,5],[3,6],[3,7],[3,8],[3,9],[4,10],[5,11],[6,12],[6,13],[6,14],[6,15],[7,16],[8,17],[9,18],[9,19],[9,20],[9,21],[10,22],[11,23]]]],237:[[0,[[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6],[7,7],[8,8],[9,9],[10,10],[11,11]]]],280:[[0,[[0,0],[1,5],[2,10],[3,15],[4,1],[5,2],[6,0],[7,5],[8,10],[9,15],[10,1],[11,2],[12,0],[13,5],[14,10],[15,15],[16,1],[17,2],[18,0],[19,5],[20,10],[21,15],[22,1],[23,2]]],[1,[[0,0],[1,0],[2,0],[3,0],[4,1],[5,4],[6,5],[7,5],[8,5],[9,5],[10,6],[11,9],[12,10],[13,10],[14,10],[15,10],[16,11],[17,14],[18,15],[19,15],[20,15],[21,15],[22,16],[23,19]]]],326:[[0,[]]],327:[[0,[[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6],[7,7],[8,8],[9,9],[10,10],[11,11]]]],328:[[0,[[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6],[7,7],[8,8],[9,9],[10,10],[11,11],[12,12],[13,13],[14,14],[15,15],[16,16],[17,17],[18,18],[19,19],[20,20],[21,21],[22,22],[23,23]]]],329:[[0,[[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6],[7,7],[8,8],[9,9],[10,10],[11,11],[12,12],[13,13],[14,14],[15,15],[16,16],[17,17],[18,18],[19,19]]]],331:[[0,[[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6],[7,7],[8,8],[9,9],[10,10],[11,11],[12,12],[13,13],[14,14],[15,15],[16,16],[17,17],[18,18],[19,19]]]],332:[[0,[[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6],[7,7],[8,8],[9,9],[10,10],[11,11],[12,12],[13,13],[14,14],[15,15],[16,16],[17,17],[18,18],[19,19]]]]},ln={233:[[0,1],[2],[3]],236:[[0],[4],[3]]},an={280:[[0,[0]],[1,[1]]]},cn={230:[],231:[],233:[231],234:[233],236:[280],280:[234,230],root:[236]},un={230:{str:"FROM data AS data",id:230,name:"Scan",schema:["a","b","c","d","e","f","g"],depth:2},231:{str:"FROM data AS data",id:231,name:"Scan",schema:["a","b","c","d","e","f","g"],depth:4},233:{str:"SELECT data.a * data.b AS x,data.c AS c,data.d AS d",id:233,name:"Project",schema:["x","c","d"],depth:3},234:{str:"234 SubQuerySource(d2)",id:234,name:"SubQuerySource",schema:["x","c","d"],depth:2},236:{str:"SELECT data.a AS a, (sum(data.b + 2.0)) * 2.0 AS c GROUP BY data.a",id:236,name:"GroupBy",schema:["a","c"],depth:0},280:{str:"HashJoin ON d2.x,data.b",id:280,name:"HashJoin",schema:["x","c","d","a","b","c","d","e","f","g"],depth:1}},fn={230:{columns:["a","b","c","d","e","f","g"],rows:[[0,0,0,0,"a",2,"c"],[1,1,1,0,"b",4,"d"],[2,2,0,0,"c",6,"e"],[3,3,1,0,"d",8,"cde"],[4,4,0,0,"abc",10,"a"],[5,0,1,0,"cde",12,"b"],[6,1,0,0,"a",14,"c"],[7,2,1,0,"b",16,"abc"],[8,3,0,0,"c",18,"c"],[9,4,1,0,"d",20,"d"],[10,0,0,0,"abc",22,"e"],[11,1,1,0,"cde",24,"cde"],[12,2,0,0,"a",26,"a"],[13,3,1,0,"b",28,"b"],[14,4,0,0,"c",30,"c"],[15,0,1,0,"d",32,"abc"],[16,1,0,0,"abc",34,"c"],[17,2,1,0,"cde",36,"d"],[18,3,0,0,"a",38,"e"],[19,4,1,0,"b",40,"cde"]]},231:{columns:["a","b","c","d","e","f","g"],rows:[[0,0,0,0,"a",2,"c"],[1,1,1,0,"b",4,"d"],[2,2,0,0,"c",6,"e"],[3,3,1,0,"d",8,"cde"],[4,4,0,0,"abc",10,"a"],[5,0,1,0,"cde",12,"b"],[6,1,0,0,"a",14,"c"],[7,2,1,0,"b",16,"abc"],[8,3,0,0,"c",18,"c"],[9,4,1,0,"d",20,"d"],[10,0,0,0,"abc",22,"e"],[11,1,1,0,"cde",24,"cde"],[12,2,0,0,"a",26,"a"],[13,3,1,0,"b",28,"b"],[14,4,0,0,"c",30,"c"],[15,0,1,0,"d",32,"abc"],[16,1,0,0,"abc",34,"c"],[17,2,1,0,"cde",36,"d"],[18,3,0,0,"a",38,"e"],[19,4,1,0,"b",40,"cde"]]},233:{columns:["x","c","d"],rows:[[0,0,0],[1,1,0],[4,0,0],[9,1,0],[16,0,0],[0,1,0],[6,0,0],[14,1,0],[24,0,0],[36,1,0],[0,0,0],[11,1,0],[24,0,0],[39,1,0],[56,0,0],[0,1,0],[16,0,0],[34,1,0],[54,0,0],[76,1,0]]},234:{columns:["x","c","d"],rows:[[0,0,0],[1,1,0],[4,0,0],[9,1,0],[16,0,0],[0,1,0],[6,0,0],[14,1,0],[24,0,0],[36,1,0],[0,0,0],[11,1,0],[24,0,0],[39,1,0],[56,0,0],[0,1,0],[16,0,0],[34,1,0],[54,0,0],[76,1,0]]},236:{columns:["a","c"],rows:[[0,16],[1,6],[4,12],[5,16],[6,6],[9,12],[10,16],[11,6],[14,12],[15,16],[16,6],[19,12]]},237:{columns:["a","c"],rows:[]},280:{columns:["x","c","d","a","b","c","d","e","f","g"],rows:[[0,0,0,0,0,0,0,"a",2,"c"],[0,1,0,0,0,0,0,"a",2,"c"],[0,0,0,0,0,0,0,"a",2,"c"],[0,1,0,0,0,0,0,"a",2,"c"],[1,1,0,1,1,1,0,"b",4,"d"],[4,0,0,4,4,0,0,"abc",10,"a"],[0,0,0,5,0,1,0,"cde",12,"b"],[0,1,0,5,0,1,0,"cde",12,"b"],[0,0,0,5,0,1,0,"cde",12,"b"],[0,1,0,5,0,1,0,"cde",12,"b"],[1,1,0,6,1,0,0,"a",14,"c"],[4,0,0,9,4,1,0,"d",20,"d"],[0,0,0,10,0,0,0,"abc",22,"e"],[0,1,0,10,0,0,0,"abc",22,"e"],[0,0,0,10,0,0,0,"abc",22,"e"],[0,1,0,10,0,0,0,"abc",22,"e"],[1,1,0,11,1,1,0,"cde",24,"cde"],[4,0,0,14,4,0,0,"c",30,"c"],[0,0,0,15,0,1,0,"d",32,"abc"],[0,1,0,15,0,1,0,"d",32,"abc"],[0,0,0,15,0,1,0,"d",32,"abc"],[0,1,0,15,0,1,0,"d",32,"abc"],[1,1,0,16,1,0,0,"abc",34,"c"],[4,0,0,19,4,1,0,"b",40,"cde"]]}},hn=`SELECT a, sum(b+2) * 2 as c 
  FROM data, (SELECT a*b as x, c, d  FROM data) AS d2 
  WHERE data.b = d2.x
  GROUP BY a`,dn=4,Fs={row:sn,col:ln,exprs:an,op:cn,info:un,results:fn,qstr:hn,plan_depth:dn},Is=Object.freeze(Object.defineProperty({__proto__:null,row:sn,col:ln,exprs:an,op:cn,info:un,results:fn,qstr:hn,plan_depth:dn,default:Fs},Symbol.toStringTag,{value:"Module"})),Rs=[{name:"sailors",csv:`sid,name,rating,age
1,Eugene,7,22
2,Luis,2,39
3,Ken,8,27`},{name:"boats",csv:`bid,name,color
101,Legacy,red
102,Melon,blue
103,Mars,red`},{name:"reserves",csv:`sid,bid,day
1,102,12
1,101,12
1,103,12
2,102,13
2,103,14`},{name:"data",csv:`a,b,c,d,e,f,g
0,0,0,0,a,2,c
1,1,1,0,b,4,d
2,2,0,0,c,6,e
3,3,1,0,d,8,cde
4,4,0,0,abc,10,a
5,0,1,0,cde,12,b
6,1,0,0,a,14,c
7,2,1,0,b,16,abc
8,3,0,0,c,18,c
9,4,1,0,d,20,d
10,0,0,0,abc,22,e
11,1,1,0,cde,24,cde
12,2,0,0,a,26,a
13,3,1,0,b,28,b
14,4,0,0,c,30,c
15,0,1,0,d,32,abc
16,1,0,0,abc,34,c
17,2,1,0,cde,36,d
18,3,0,0,a,38,e
19,4,1,0,b,40,cde`}];class Ms{constructor(){Be(this,"pyodide");Be(this,"state");Be(this,"cbs",[]);this.state=-1}onLoaded(t){this.cbs.push(t)}async init(t){if(!this.state!=-1)return this.pyodide?(this.state=1,ee):(t=t!=null?t:{},this.state=0,t.innerHTML="(  0%) Loading Pyodide..",window.pyodide=this.pyodide=await loadPyodide(),await ne(),t.innerHTML="( 10%) Loading micropip..",await this.pyodide.loadPackage(["micropip"]),await ne(),t.innerHTML="( 20%) Loading pandas..",await this.pyodide.loadPackage(["pandas","python-dateutil"]),await ne(),t.innerHTML="( 60%) Loading parsimonious wheel..",await this.pyodide.runPythonAsync(`
import pandas as pd
import io
import json
import micropip
await micropip.install("./parsimonious-0.9.0-py3-none-any.whl")
   `),await ne(),t.innerHTML="( 80%) Loading databass wheel..",await this.pyodide.runPythonAsync(`
await micropip.install('./databass-0.0.1-py3-none-any.whl')
import databass 
from databass import *
db = Database.db()
    `),t.innerHTML="(100%) Ready!",this.state=1,this.loadDatasets(),this.cbs.forEach(n=>n(this)),this.pyodide)}loadDatasets(){Rs.forEach(({name:t,csv:n})=>{this.registerCSV(t,n)})}schemas(){let t=this.pyodide.runPython(`
db = Database.db()
schemas = []
for name in db.tablenames:
  schema = [f"{a.aname} {a.typ}" for a in db.schema(name)]
  schemas.append([name, ", ".join(schema)])
json.dumps(schemas)
`);return console.log("schemas",t),JSON.parse(t)}registerCSV(t,n){self.pyodide.runPython(`
csv = """${n}"""
data = pd.read_csv(io.StringIO(csv))
db.register_dataframe("${t}", data)
    `)}isLoaded(){return this.state==1}}let ee=new Ms;function zs(){var e=new Date().getTime(),t=performance&&performance.now&&performance.now()*1e3||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var r=Math.random()*16;return e>0?(r=(e+r)%16|0,e=Math.floor(e/16)):(r=(t+r)%16|0,t=Math.floor(t/16)),(n==="x"?r:r&3|8).toString(16)})}var je=Hs,Ue=Ws,G=[],V=[],Ps=typeof Uint8Array<"u"?Uint8Array:Array,Ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var ae=0,js=Ge.length;ae<js;++ae)G[ae]=Ge[ae],V[Ge.charCodeAt(ae)]=ae;V["-".charCodeAt(0)]=62;V["_".charCodeAt(0)]=63;function Us(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function Vs(e,t,n){return(t+n)*3/4-n}function Hs(e){var t,n=Us(e),r=n[0],o=n[1],i=new Ps(Vs(e,r,o)),s=0,l=o>0?r-4:r,c;for(c=0;c<l;c+=4)t=V[e.charCodeAt(c)]<<18|V[e.charCodeAt(c+1)]<<12|V[e.charCodeAt(c+2)]<<6|V[e.charCodeAt(c+3)],i[s++]=t>>16&255,i[s++]=t>>8&255,i[s++]=t&255;return o===2&&(t=V[e.charCodeAt(c)]<<2|V[e.charCodeAt(c+1)]>>4,i[s++]=t&255),o===1&&(t=V[e.charCodeAt(c)]<<10|V[e.charCodeAt(c+1)]<<4|V[e.charCodeAt(c+2)]>>2,i[s++]=t>>8&255,i[s++]=t&255),i}function Js(e){return G[e>>18&63]+G[e>>12&63]+G[e>>6&63]+G[e&63]}function Qs(e,t,n){for(var r,o=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255),o.push(Js(r));return o.join("")}function Ws(e){for(var t,n=e.length,r=n%3,o=[],i=16383,s=0,l=n-r;s<l;s+=i)o.push(Qs(e,s,s+i>l?l:s+i));return r===1?(t=e[n-1],o.push(G[t>>2]+G[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],o.push(G[t>>10]+G[t>>4&63]+G[t<<2&63]+"=")),o.join("")}const pn=!0,_e=BigInt("-9223372036854775808"),it=BigInt("9223372036854775807"),Ke=BigInt("0"),Ds=BigInt("8"),Gs=BigInt("256");class Le{constructor(t,n){this.tableName=t,this.id=n}equals(t){return t instanceof Le?this.tableName===t.tableName&&this.id===t.id:!1}static fromJSON(t){if(typeof t.$id!="string")throw new Error(`Object ${JSON.stringify(t)} isn't a valid Id: $id isn't a string.`);const n=t.$id.split("|");if(n.length!==2)throw new Error(`Object ${JSON.stringify(t)} isn't a valid Id: Wrong number of parts.`);return new Le(n[0],n[1])}toJSON(){return{$id:`${this.tableName}|${this.id}`}}toString(){return this.id}inspect(){return`Id('${this.tableName}', '${this.id}')`}}function mn(e){return Number.isNaN(e)||!Number.isFinite(e)||Object.is(e,-0)}function Xs(e){e<Ke&&(e-=_e+_e);let t=e.toString(16);t.length%2==1&&(t="0"+t);const n=new Uint8Array(new ArrayBuffer(8));let r=0;for(const o of t.match(/.{2}/g).reverse())n.set([parseInt(o,16)],r++),e>>=Ds;return Ue(n)}function Ys(e){const t=je(e);if(t.byteLength!==8)throw new Error(`Received ${t.byteLength} bytes, expected 8 for $integer`);let n=Ke,r=Ke;for(const o of t)n+=BigInt(o)*Gs**r,r++;return n>it&&(n+=_e+_e),n}function Ks(e){if(e<_e||it<e)throw new Error(`BigInt ${e} does not fit into a 64-bit signed integer.`);const t=new ArrayBuffer(8);return new DataView(t).setBigInt64(0,e,!0),Ue(new Uint8Array(t))}function Zs(e){const t=je(e);if(t.byteLength!==8)throw new Error(`Received ${t.byteLength} bytes, expected 8 for $integer`);return new DataView(t.buffer).getBigInt64(0,!0)}const ei=DataView.prototype.setBigInt64?Ks:Xs,ti=DataView.prototype.getBigInt64?Zs:Ys,Ot=64,ni=/^_+$/,ri=/^[a-zA-Z_][a-zA-Z0-9_]{0,63}$/;function yn(e){if(e.length===0)throw new Error("Empty field names are disallowed.");if(e.length>Ot)throw new Error(`Field name ${e} exceeds maximum field name length ${Ot}.`);if(e.startsWith("$"))throw new Error(`Field name ${e} starts with a '$', which is reserved.`);if(ni.test(e))throw new Error(`Field name ${e} can't exclusively be underscores.`);if(!ri.test(e))throw new Error(`Field name ${e} must only contain alphanumeric characters or underscores and can't start with a number.`)}function ue(e){if(e===null||typeof e=="boolean"||typeof e=="number"||typeof e=="string")return e;if(e instanceof Array)return e.map(ue);if(typeof e!="object")throw new Error(`Unexpected type of ${e}`);const t=Object.entries(e);if(t.length===1){const r=t[0][0];if(r==="$id"||r==="$weakRef"||r==="$strongRef")return Le.fromJSON(e);if(r==="$bytes"){if(typeof e.$bytes!="string")throw new Error(`Malformed $bytes field on ${e}`);return je(e.$bytes).buffer}if(r==="$integer"){if(typeof e.$integer!="string")throw new Error(`Malformed $integer field on ${e}`);return ti(e.$integer)}if(r==="$float"){if(typeof e.$float!="string")throw new Error(`Malformed $float field on ${e}`);const o=je(e.$float);if(o.byteLength!==8)throw new Error(`Received ${o.byteLength} bytes, expected 8 for $float`);const s=new DataView(o.buffer).getFloat64(0,pn);if(!mn(s))throw new Error(`Float ${s} should be encoded as a number`);return s}if(r==="$set"){if(!(e.$set instanceof Array))throw new Error(`Malformed $set field on ${e}`);return new Set(e.$set.map(ue))}if(r==="$map"){if(!(e.$map instanceof Array))throw new Error(`Malformed $map field on ${e}`);const o=new Map;for(const i of e.$map){if(!(i instanceof Array)||i.length!==2)throw new Error(`Malformed pair in $map ${e}`);const s=ue(i[0]),l=ue(i[1]);o.set(s,l)}return o}}const n={};for(const[r,o]of Object.entries(e))yn(r),n[r]=ue(o);return n}function Lt(e){return ue(e)}function fe(e,t,n){if(e===void 0)throw new Error(`undefined is not a valid Convex value (present at path ${n} in original object ${JSON.stringify(t)}). To learn about Convex's supported types, see https://docs.convex.dev/using/types.`);if(e===null)return e;if(e instanceof Le)return e.toJSON();if(typeof e=="bigint"){if(e<_e||it<e)throw new Error(`BigInt ${e} does not fit into a 64-bit signed integer.`);return{$integer:ei(e)}}if(typeof e=="number")if(mn(e)){const i=new ArrayBuffer(8);return new DataView(i).setFloat64(0,e,pn),{$float:Ue(new Uint8Array(i))}}else return e;if(typeof e=="boolean"||typeof e=="string")return e;if(e instanceof ArrayBuffer)return{$bytes:Ue(new Uint8Array(e))};if(e instanceof Array)return e.map((i,s)=>fe(i,t,n+`[${s}]`));if(e instanceof Set)return{$set:[...e].map((i,s)=>fe(i,t,n+`.keys()[${s}]`))};if(e instanceof Map)return{$map:[...e].map(([i,s],l)=>{const c=fe(i,t,n+`.keys()[${l}]`),a=fe(s,t,n+`.values()[${l}]`);return[c,a]})};if(typeof e!="object")throw new Error(`${e} is not a supported Convex type (present at path ${n} in original object ${JSON.stringify(t)}). To learn about Convex's supported types, see https://docs.convex.dev/using/types.`);const r=Object.getPrototypeOf(e);if(r!==null&&r!==Object.prototype)throw new Error(`${e} is not a supported Convex type (present at path ${n} in original object ${JSON.stringify(t)}). To learn about Convex's supported types, see https://docs.convex.dev/using/types.`);const o={};for(const[i,s]of Object.entries(e))yn(i),o[i]=fe(s,t,n+`.${i}`);return o}function Tt(e){return fe(e,e,"")}const oi="0.1.10",Nt=560,si="color:rgb(0, 145, 255)";function Bt(e,t,n,r){const o=t==="query"?"Q":"M";e=="info"?console.log(`%c[CONVEX ${o}(${n})] ${r}`,si):console.error(`[CONVEX ${o}(${n})] ${r}`)}function $t(e,t,n){const r=e==="query"?"Q":"M";return new Error(`[CONVEX ${r}(${t})] ${n}`)}const ii="modulepreload",li=function(e){return"/sqltutor/"+e},qt={},ai=function(t,n,r){return!n||n.length===0?t():Promise.all(n.map(o=>{if(o=li(o),o in qt)return;qt[o]=!0;const i=o.endsWith(".css"),s=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${s}`))return;const l=document.createElement("link");if(l.rel=i?"stylesheet":ii,i||(l.as="script",l.crossOrigin=""),l.href=o,document.head.appendChild(l),i)return new Promise((c,a)=>{l.addEventListener("load",c),l.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())},ci=typeof window<"u"&&typeof window.fetch<"u",Ft=ci?window.fetch:(...e)=>ai(()=>import("./index.698e980f.js"),[]).then(({default:t})=>t(...e));class ui{constructor(t){this.address=`${t.address}/api/${oi}`}backendUrl(){return this.address}setAuth(t){this.auth=t}clearAuth(){this.auth=void 0}query(t){return async(...n)=>{const r=JSON.stringify(Tt(n)),o=encodeURIComponent(r),i=`${this.address}/udf?path=${t}&args=${o}`,s=this.auth?{Authorization:`Bearer ${this.auth}`}:{},l=await Ft(i,{credentials:"include",headers:s});if(!l.ok&&l.status!=Nt)throw new Error(await l.text());const c=await l.json(),a=Lt(c.value);for(const u of c.logs)Bt("info","query",t,u);if(!c.success)throw $t("query",t,a);return a}}mutation(t){return async(...n)=>{const r=JSON.stringify({path:t,args:Tt(n),tokens:[]}),o={"Content-Type":"application/json"};this.auth&&(o.Authorization=`Bearer ${this.auth}`);const i=await Ft(`${this.address}/udf`,{body:r,method:"POST",headers:o,credentials:"include"});if(!i.ok&&i.status!=Nt)throw new Error(await i.text());const s=await i.json(),l=Lt(s.value);for(const c of s.logs)Bt("info","mutation",t,c);if(!s.success)throw $t("mutation",t,l);return l}}}const fi={address:"https://nautical-quetzal-892.convex.cloud"};function It(e,t,n){const r=e.slice();return r[31]=t[n][0],r[32]=t[n][1],r}function hi(e){return{c:$,m:$,p:$,i:$,o:$,d:$}}function di(e){let t,n,r,o,i,s,l,c,a,u,h,y,_,m,d,S,E,p,w,C,q,J,j,z,U,D,F;i=new Ls({props:{onSelect:e[14]}});let L=e[7],v=[];for(let A=0;A<L.length;A+=1)v[A]=Rt(It(e,L,A));return{c(){t=b("div"),n=b("h3"),r=R(`SQL
        `),o=b("small"),xe(i.$$.fragment),s=O(),l=b("textarea"),c=O(),a=b("button"),a.textContent="Visualize Query",u=O(),h=b("div"),y=b("h3"),_=R(`CSV 
        `),m=b("small"),d=b("input"),S=O(),E=b("textarea"),p=O(),w=b("button"),w.textContent="Add Table",C=O(),q=b("div"),J=b("h3"),J.textContent="Tables",j=O(),z=b("ul");for(let A=0;A<v.length;A+=1)v[A].c();g(o,"class","svelte-kvadip"),g(l,"class","editor svelte-kvadip"),g(l,"id","q"),g(a,"class","btn btn-primary"),te(a,"width","100%"),g(t,"class","col-md-3"),g(d,"placeholder","New Table Name"),g(m,"class","svelte-kvadip"),g(E,"class","editor svelte-kvadip"),g(E,"id","csv"),g(w,"class","btn btn-primary"),te(w,"width","100%"),g(h,"class","col-md-3"),g(z,"class","schema svelte-kvadip"),g(q,"class","col-md-3")},m(A,x){N(A,t,x),f(t,n),f(n,r),f(n,o),pe(i,o,null),f(t,s),f(t,l),e[20](l),M(l,e[0]),f(t,c),f(t,a),N(A,u,x),N(A,h,x),f(h,y),f(y,_),f(y,m),f(m,d),M(d,e[6]),f(h,S),f(h,E),e[23](E),M(E,e[8]),f(h,p),f(h,w),N(A,C,x),N(A,q,x),f(q,J),f(q,j),f(q,z);for(let k=0;k<v.length;k+=1)v[k].m(z,null);U=!0,D||(F=[I(l,"input",e[21]),I(a,"click",e[13]),I(d,"input",e[22]),I(E,"input",e[24]),I(w,"click",e[12])],D=!0)},p(A,x){if(x[0]&1&&M(l,A[0]),x[0]&64&&d.value!==A[6]&&M(d,A[6]),x[0]&256&&M(E,A[8]),x[0]&128){L=A[7];let k;for(k=0;k<L.length;k+=1){const Ne=It(A,L,k);v[k]?v[k].p(Ne,x):(v[k]=Rt(Ne),v[k].c(),v[k].m(z,null))}for(;k<v.length;k+=1)v[k].d(1);v.length=L.length}},i(A){U||(P(i.$$.fragment,A),U=!0)},o(A){Q(i.$$.fragment,A),U=!1},d(A){A&&T(t),me(i),e[20](null),A&&T(u),A&&T(h),e[23](null),A&&T(C),A&&T(q),Ze(v,A),D=!1,Y(F)}}}function Rt(e){let t,n,r=e[31]+"",o,i,s=e[32]+"",l,c;return{c(){t=b("li"),n=b("b"),o=R(r),i=R("("),l=R(s),c=R(")"),g(t,"class","svelte-kvadip")},m(a,u){N(a,t,u),f(t,n),f(n,o),f(t,i),f(t,l),f(t,c)},p(a,u){u[0]&128&&r!==(r=a[31]+"")&&re(o,r),u[0]&128&&s!==(s=a[32]+"")&&re(l,s)},d(a){a&&T(t)}}}function pi(e){let t,n,r,o,i,s,l,c,a,u,h,y,_,m,d,S,E;return{c(){t=b("div"),n=b("h3"),n.textContent="SQL",r=O(),o=b("textarea"),i=O(),s=b("button"),s.textContent="Loading libraries...",l=O(),c=b("div"),a=b("h3"),a.textContent="CSV",u=O(),h=b("textarea"),y=O(),_=b("button"),_.textContent="Loading libraries...",m=O(),d=b("div"),d.innerHTML=`<h3>Database</h3>
      Loading...`,g(o,"class","editor svelte-kvadip"),o.disabled=!0,g(s,"class","btn btn-secondary"),s.disabled=!0,te(s,"width","100%"),g(t,"class","col-md-3"),g(h,"class","editor svelte-kvadip"),h.disabled=!0,g(_,"class","btn btn-secondary"),_.disabled=!0,te(_,"width","100%"),g(c,"class","col-md-3"),g(d,"class","col-md-3")},m(p,w){N(p,t,w),f(t,n),f(t,r),f(t,o),M(o,e[0]),f(t,i),f(t,s),N(p,l,w),N(p,c,w),f(c,a),f(c,u),f(c,h),M(h,e[8]),f(c,y),f(c,_),N(p,m,w),N(p,d,w),S||(E=[I(o,"input",e[18]),I(h,"input",e[19])],S=!0)},p(p,w){w[0]&1&&M(o,p[0]),w[0]&256&&M(h,p[8])},i:$,o:$,d(p){p&&T(t),p&&T(l),p&&T(c),p&&T(m),p&&T(d),S=!1,Y(E)}}}function Mt(e){let t,n,r,o,i,s,l;return r=new ms({props:{h:e[9].plan_depth*50+100}}),s=new Cs({props:{opids:e[10]}}),{c(){t=b("div"),n=b("div"),xe(r.$$.fragment),o=O(),i=b("div"),xe(s.$$.fragment),g(n,"class","col-md-4"),g(i,"class","col-md-8"),g(t,"class","row viscontainer svelte-kvadip")},m(c,a){N(c,t,a),f(t,n),pe(r,n,null),e[25](n),f(t,o),f(t,i),pe(s,i,null),l=!0},p(c,a){const u={};a[0]&512&&(u.h=c[9].plan_depth*50+100),r.$set(u);const h={};a[0]&1024&&(h.opids=c[10]),s.$set(h)},i(c){l||(P(r.$$.fragment,c),P(s.$$.fragment,c),l=!0)},o(c){Q(r.$$.fragment,c),Q(s.$$.fragment,c),l=!1},d(c){c&&T(t),me(r),e[25](null),me(s)}}}function zt(e){let t,n,r,o,i,s,l;return{c(){t=b("div"),n=b("div"),r=b("div"),o=b("h3"),o.innerHTML='Could Not Parse Query <small class="svelte-kvadip"><a href="#" data-bs-toggle="modal" data-bs-target="#modalBug" class="svelte-kvadip">report bug</a></small>',i=O(),s=b("pre"),l=R(e[1]),g(r,"class","bd-callout bd-callout-danger svelte-kvadip"),g(r,"role","alert"),g(n,"class","col-md-12"),g(t,"class","row errcontainer svelte-kvadip")},m(c,a){N(c,t,a),f(t,n),f(n,r),f(r,o),f(r,i),f(r,s),f(s,l)},p(c,a){a[0]&2&&re(l,c[1])},d(c){c&&T(t)}}}function mi(e){let t,n,r,o,i,s,l,c,a,u,h,y,_,m,d,S,E,p,w,C,q,J,j,z,U,D;t=new qs({props:{id:"modalBug",reportBug:e[15]}});let F={ctx:e,current:null,token:null,hasCatch:!1,pending:pi,then:di,catch:hi,blocks:[,,,]};Nn(ee.init(e[11]),F);let L=e[9]&&Mt(e),v=e[1]&&zt(e);return{c(){xe(t.$$.fragment),n=O(),r=b("main"),o=b("h1"),o.innerHTML='SQLTutor Visualizes Query Execution <small class="svelte-kvadip"><a href="https://github.com/cudbg/sqltutor" class="svelte-kvadip">github</a></small>',i=O(),s=b("div"),l=b("div"),c=b("h3"),c.textContent="About",a=O(),u=b("p"),u.innerHTML=`<strong>SQLTutor</strong> visualizes each operator in the SQL query plan.  
      Click on an operator to visualize its input and output tables, along with their row/column dependencies (called <a href="https://arxiv.org/abs/1801.07237" class="svelte-kvadip">data provenance</a>) .  
      You can add new tables using the <mark>CSV</mark> textarea.  The CSV should include a header row.
      Use <mark>\u2190</mark> and <mark>\u2192</mark> to visualize the prev/next operator.`,h=O(),y=b("p"),y.innerHTML='This is an early release!  SQLTutor currently only supports very simple queries and <a href="https://github.com/w6113/databass-public/blob/master/databass/parse_sql.py" class="svelte-kvadip">follows a simple grammar</a>.    We hope to eventually support DuckDB as the backend in a future release.',_=O(),m=b("p"),m.innerHTML=`<a href="#" class="link svelte-kvadip" data-bs-toggle="modal" data-bs-target="#modalBug">Report a bug or feature request</a>. 
      <br/> 
      <a href="https://cudbg.github.io/sql2pandas/" class="link svelte-kvadip">Learning Pandas too?  Check out sql2pandas</a>`,d=O(),S=b("p"),E=R(`permalink
        `),p=b("input"),w=O(),F.block.c(),C=O(),L&&L.c(),q=O(),v&&v.c(),J=O(),j=b("div"),j.innerHTML=`<div class="col-md-8 offset-md-2 text-center" style="border-top: 1px solid grey;"><p><span class="text-muted">SQLTutor created by <a href="https://eugenewu.net" class="svelte-kvadip">Eugene Wu</a> and Robert Ward</span></p> 

      <p style="font-size:smaller;">See <a href="https://github.com/cudbg/sqltutor" class="svelte-kvadip">github repo</a> for code.   
      Implemented using the instructional 
        <a href="https://github.com/w6113/databass-public" class="svelte-kvadip">Databass DBMS</a>
        developed for Columbia&#39;s <a href="https://w6113.github.io" class="svelte-kvadip">COMS6113</a>,
        <a href="https://pyodide.org/" class="svelte-kvadip">pyodide</a>,
        <a href="https://convex.dev/" class="svelte-kvadip">convex</a>,
        and table vis from <a href="https://pandastutor.com/" class="svelte-kvadip">pandastutor</a>.</p> 

      <p style="font-size:smaller;">Privacy Policy: By using SQLTutor, your queries, csvs, user interactions, and IP address are logged and may be analyzed for research purposes. Nearly all web services collect this basic information from users in their server logs. SQLTutor does not collect any personally identifiable information from its users.</p></div>`,te(m,"font-size","smaller"),g(p,"type","text"),g(p,"class","permalink"),te(p,"width","100%"),g(S,"class","text-muted"),te(S,"font-size","smaller"),g(l,"class","col-md-3"),g(s,"class","row"),g(j,"class","row footer"),te(j,"margin-top","3em"),g(r,"class","container-xl")},m(A,x){pe(t,A,x),N(A,n,x),N(A,r,x),f(r,o),f(r,i),f(r,s),f(s,l),f(l,c),f(l,a),f(l,u),f(l,h),f(l,y),f(l,_),f(l,m),f(l,d),f(l,S),f(S,E),f(S,p),M(p,e[5]),f(s,w),F.block.m(s,F.anchor=null),F.mount=()=>s,F.anchor=null,f(r,C),L&&L.m(r,null),f(r,q),v&&v.m(r,null),f(r,J),f(r,j),z=!0,U||(D=I(p,"input",e[17]),U=!0)},p(A,x){e=A,x[0]&32&&p.value!==e[5]&&M(p,e[5]),Bn(F,e,x),e[9]?L?(L.p(e,x),x[0]&512&&P(L,1)):(L=Mt(e),L.c(),P(L,1),L.m(r,q)):L&&(tt(),Q(L,1,1,()=>{L=null}),nt()),e[1]?v?v.p(e,x):(v=zt(e),v.c(),v.m(r,J)):v&&(v.d(1),v=null)},i(A){z||(P(t.$$.fragment,A),P(F.block),P(L),z=!0)},o(A){Q(t.$$.fragment,A);for(let x=0;x<3;x+=1){const k=F.blocks[x];Q(k)}Q(L),z=!1},d(A){me(t,A),A&&T(n),A&&T(r),F.block.d(),F.token=null,F=null,L&&L.d(),v&&v.d(),U=!1,D()}}}function yi(e,t,n){var lt;let r,o;de(e,Ee,B=>n(9,r=B)),de(e,he,B=>n(10,o=B));const i=new ui(fi);window.convex=i;const s=zs(),l=i.mutation("addStat");let c=document.getElementById("msg"),a=new URLSearchParams(window.location.search);Se(Ee,r=Is,r);let u=null,h,y,_,m="",d,S=[],E=[],p=(lt=a.get("q"))!=null?lt:`SELECT a, sum(b+2) * 2 as c 
FROM data, (SELECT a*b as x, c, d  FROM data) AS d2 
WHERE data.b = d2.x
GROUP BY a`,w=`a,b,c,d,e,f,g
0,0,0,0,a,2,c
1,1,1,0,b,4,d
2,2,0,0,c,6,e
3,3,1,0,d,8,cde
4,4,0,0,abc,10,a
5,0,1,0,cde,12,b
6,1,0,0,a,14,c
7,2,1,0,b,16,abc
8,3,0,0,c,18,c
9,4,1,0,d,20,d`;function C(B){let ie=`json_str_for_vis("""${B}""")`;console.log(ie);try{let ve=ee.pyodide.runPython(ie),_n=JSON.parse(ve);e:n(1,u=null);return _n}catch(ve){n(1,u=ve)}}async function q(){if(d){try{if(w.split(`
`).length>15){e:n(1,u="CSV too large for the visualizer to be useful.  Please limit table to 15 rows.");return}ee.registerCSV(d,w),E.push({name:d,csv:w})}catch(B){n(1,u=B)}n(6,d=null),n(7,S=ee.schemas()),n(16,E)}else n(1,u="New table needs a name!")}function J(){l(s,p,w,u,!1,null,null),Se(Ee,r=C(p),r)}function j(B){console.log("selected dropdown",B),n(0,p=B)}ee.onLoaded(()=>{let B=a.get("csvs");console.log("loaded csvs from url",B),B&&(n(16,E=JSON.parse(B)),E.forEach(({name:ie,csv:ve})=>ee.registerCSV(ie,ve))),n(7,S=ee.schemas())}),Te(()=>{});function z(B,ie){l(s,p,JSON.stringify(E),u,!0,B,ie)}function U(){m=this.value,n(5,m),n(0,p),n(16,E)}function D(){p=this.value,n(0,p)}function F(){w=this.value,n(8,w)}function L(B){X[B?"unshift":"push"](()=>{y=B,n(3,y)})}function v(){p=this.value,n(0,p)}function A(){d=this.value,n(6,d)}function x(B){X[B?"unshift":"push"](()=>{_=B,n(4,_)})}function k(){w=this.value,n(8,w)}function Ne(B){X[B?"unshift":"push"](()=>{h=B,n(2,h)})}return e.$$.update=()=>{e.$$.dirty[0]&65537&&n(5,m=`https://cudbg.github.io/sqltutor/?q=${encodeURI(p)}&csvs=${encodeURI(JSON.stringify(E))}`)},[p,u,h,y,_,m,d,S,w,r,o,c,q,J,j,z,E,U,D,F,L,v,A,x,k,Ne]}class _i extends be{constructor(t){super(),ge(this,t,yi,mi,se,{},null,[-1,-1])}}new _i({target:document.getElementById("app")});
